{"version":3,"sources":["Zvezdochki.js"],"names":["Zvezdochki","el","options","ratingEl","activeClass","votes","starDataAttr","ratingDataAttr","votedClassName","voted","Object","assign","stars","querySelectorAll","init","setInitialRating","blockVotes","handleHover","addClickHandler","star","voteEvent","CustomEvent","detail","dispatchEvent","classList","add","style","pointerEvents","initialRating","dataset","toLowerCase","setActiveStar","rating","querySelector","forEach","addEventListener","remove","ev","preventDefault","stopPropagation","target","submit"],"mappings":";;;AAsFG,aAAA,SAAA,EAAA,EAAA,GAAA,KAAA,aAAA,GAAA,MAAA,IAAA,UAAA,qCAAA,SAAA,EAAA,EAAA,GAAA,IAAA,IAAA,EAAA,EAAA,EAAA,EAAA,OAAA,IAAA,CAAA,IAAA,EAAA,EAAA,GAAA,EAAA,WAAA,EAAA,aAAA,EAAA,EAAA,cAAA,EAAA,UAAA,IAAA,EAAA,UAAA,GAAA,OAAA,eAAA,EAAA,EAAA,IAAA,IAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,GAAA,EAAA,EAAA,UAAA,GAAA,GAAA,EAAA,EAAA,GAAA,EAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,gBAAA,EAtFH,QAAA,gBAEaA,IAAAA,EAoFV,WAnFWC,SAAAA,EAAAA,EAAIC,GAAS,EAAA,KAAA,GAClBC,KAAAA,SAAWF,EAEXC,KAAAA,QAAU,CACbE,YAAa,SACbC,MAAO,QACPC,aAAc,OACdC,eAAgB,cAChBC,eAAgB,uBAChBC,OAAO,GAGLR,GAAMC,IACHA,KAAAA,QAAUQ,OAAOC,OAAO,KAAKT,QAASA,IAGxCU,KAAAA,MAAQ,KAAKT,SAASU,iBAAiB,SAAW,KAAKX,QAAQI,aAAe,KAE9EQ,KAAAA,OAiEN,OAAA,EAAA,EAAA,CAAA,CAAA,IAAA,OA7DM,MAAA,WACAC,KAAAA,mBAEA,KAAKb,QAAQO,MAIXO,KAAAA,cAHAC,KAAAA,cACAC,KAAAA,qBAwDR,CAAA,IAAA,SAlDMC,MAAAA,SAAAA,GACDC,IAAAA,EAAY,IAAIC,YAAY,OAAQ,CAACC,OAAQH,IAC5ChB,KAAAA,SAASoB,cAAcH,KAgD7B,CAAA,IAAA,aA7CY,MAAA,WACNjB,KAAAA,SAASqB,UAAUC,IAAI,KAAKvB,QAAQM,gBACpCN,KAAAA,QAAQO,OAAQ,EAChBN,KAAAA,SAASuB,MAAMC,eAAgB,IA0CrC,CAAA,IAAA,mBAvCkB,MAAA,WACbC,IAAAA,EAAgB,KAAKzB,SAAS0B,QAAQ,KAAK3B,QAAQK,eAAeuB,eACjEC,KAAAA,cAAcH,KAqCpB,CAAA,IAAA,gBAlCaI,MAAAA,SAAAA,GACG,KAAK7B,SAAS8B,cAAc,UAAY,KAAK/B,QAAQI,aAAe,KAAO0B,EAAS,MAC1FR,UAAUC,IAAI,KAAKvB,QAAQE,eAgCrC,CAAA,IAAA,cA7Ba,MAAA,WAAA,IAAA,EAAA,KACPQ,KAAAA,MAAMsB,QAAQ,SAAAjC,GACjBA,EAAGkC,iBAAiB,aAAc,WAChC,EAAKvB,MAAMsB,QAAQ,SAAAjC,GACjBA,EAAGuB,UAAUY,OAAO,EAAKlC,QAAQE,iBAIrCH,EAAGkC,iBAAiB,aAAc,WAChC,EAAKpB,yBAoBV,CAAA,IAAA,kBAfiB,MAAA,WAAA,IAAA,EAAA,KACXZ,KAAAA,SAASgC,iBAAiB,QAAS,SAAAE,GAIlCA,GAHJA,EAAGC,iBACHD,EAAGE,kBAECF,EAAGG,OAAOX,QAAQ,EAAK3B,QAAQI,gBAAkB,EAAKJ,QAAQO,MAAO,CACnEuB,IAAAA,EAASK,EAAGG,OAAOX,QAAQ,EAAK3B,QAAQI,cAC5C+B,EAAGG,OAAOhB,UAAUC,IAAI,EAAKvB,QAAQE,aACrC,EAAKD,SAAS0B,QAAQ,EAAK3B,QAAQK,eAAeuB,eAAiBE,EAEnE,EAAKS,OAAOT,GAEZ,EAAKhB,oBAGV,EAAA,GAAA,QAAA,WAAA","file":"Zvezdochki.3283b0c3.js","sourceRoot":"../src","sourcesContent":["import \"./index.scss\";\n\nexport class Zvezdochki {\n  constructor(el, options) {\n    this.ratingEl = el;\n\n    this.options = {\n      activeClass: \"active\",\n      votes: \"votes\",\n      starDataAttr: \"star\",\n      ratingDataAttr: \"ratingValue\",\n      votedClassName: 'star-rating--blocked',\n      voted: false\n    };\n\n    if (el && options) {\n      this.options = Object.assign(this.options, options)\n    }\n\n    this.stars = this.ratingEl.querySelectorAll(\"[data-\" + this.options.starDataAttr + \"]\");\n\n    this.init();\n\n  }\n\n  init() {\n    this.setInitialRating();\n\n    if (!this.options.voted) {\n      this.handleHover();\n      this.addClickHandler();\n    } else {\n      this.blockVotes();\n    }\n  }\n\n  submit(star) {\n    let voteEvent = new CustomEvent('vote', {detail: star});\n    this.ratingEl.dispatchEvent(voteEvent);\n  }\n\n  blockVotes() {\n    this.ratingEl.classList.add(this.options.votedClassName);\n    this.options.voted = true;\n    this.ratingEl.style.pointerEvents = false;\n  }\n\n  setInitialRating() {\n    let initialRating = this.ratingEl.dataset[this.options.ratingDataAttr.toLowerCase()];\n    this.setActiveStar(initialRating);\n  }\n\n  setActiveStar(rating) {\n    let activeEl = this.ratingEl.querySelector('*[data-' + this.options.starDataAttr + '=\"' + rating + '\"]');\n    activeEl.classList.add(this.options.activeClass);\n  }\n\n  handleHover() {\n    this.stars.forEach(el => {\n      el.addEventListener('mouseenter', () => {\n        this.stars.forEach(el => {\n          el.classList.remove(this.options.activeClass)\n        })\n      });\n\n      el.addEventListener(\"mouseleave\", () => {\n        this.setInitialRating()\n      })\n    });\n  }\n\n  addClickHandler() {\n    this.ratingEl.addEventListener('click', ev => {\n      ev.preventDefault();\n      ev.stopPropagation();\n\n      if (ev.target.dataset[this.options.starDataAttr] && !this.options.voted) {\n        let rating = ev.target.dataset[this.options.starDataAttr];\n        ev.target.classList.add(this.options.activeClass);\n        this.ratingEl.dataset[this.options.ratingDataAttr.toLowerCase()] = rating;\n\n        this.submit(rating);\n\n        this.blockVotes();\n      }\n    });\n  }\n}\n\n"]}